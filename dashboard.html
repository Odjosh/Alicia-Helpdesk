<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alicia Helpdesk | Dashboard</title>
    <link rel="icon" type="image/png" href="assets/images/alicia_logo.png">
    <link rel="stylesheet" href="css/main.css">
    <script type="text/javascript" src="javascript/app.js" defer></script>
</head>
<body>
    <nav id="sidebar">
        <ul>
            <li>
                <img src="../assets/images/alicia_logo.png" height="40px" width="40px">
                <span class="logo">Alicia</span>
                <button onclick=toggleSidebar() id="toggle-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M440-240 200-480l240-240 56 56-183 184 183 184-56 56Zm264 0L464-480l240-240 56 56-183 184 183 184-56 56Z"/></svg>
                </button>
            </li>
            <li>
                <a href="index.html">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M240-200h120v-240h240v240h120v-360L480-740 240-560v360Zm-80 80v-480l320-240 320 240v480H520v-240h-80v240H160Zm320-350Z"/></svg>
                    <span>Home</span>
                </a>
            </li>
            <li class="active">
                <a href="dashboard.html">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M520-600v-240h320v240H520ZM120-440v-400h320v400H120Zm400 320v-400h320v400H520Zm-400 0v-240h320v240H120Zm80-400h160v-240H200v240Zm400 320h160v-240H600v240Zm0-480h160v-80H600v80ZM200-200h160v-80H200v80Zm160-320Zm240-160Zm0 240ZM360-280Z"/></svg>
                    <span>Dashboard</span>
                </a>
            </li>
            <li>
                <button onclick=toggleSubMenu(this) class="dropdown-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h168q13-36 43.5-58t68.5-22q38 0 68.5 22t43.5 58h168q33 0 56.5 23.5T840-760v268q-19-9-39-15.5t-41-9.5v-243H200v560h242q3 22 9.5 42t15.5 38H200Zm0-120v40-560 243-3 280Zm80-40h163q3-21 9.5-41t14.5-39H280v80Zm0-160h244q32-30 71.5-50t84.5-27v-3H280v80Zm0-160h400v-80H280v80Zm200-190q13 0 21.5-8.5T510-820q0-13-8.5-21.5T480-850q-13 0-21.5 8.5T450-820q0 13 8.5 21.5T480-790ZM720-40q-83 0-141.5-58.5T520-240q0-83 58.5-141.5T720-440q83 0 141.5 58.5T920-240q0 83-58.5 141.5T720-40Zm-20-80h40v-100h100v-40H740v-100h-40v100H600v40h100v100Z"/></svg>
                    <span>Request</span>
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M480-344 240-584l56-56 184 184 184-184 56 56-240 240Z"/></svg>
                </button>
                <ul class="sub-menu">
                    <div>
                        <li><a href="ticket.html">Submit Ticket</a></li>
                        <li><a href="asset.html">Asset Request</a></li>
                        <li><a href="feedback.html">Feedback</a></li>  
                    </div> 
                </ul>
            </li>
            
            <li>
                <a href="knowledgebase.html">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M660-160h40v-160h-40v160Zm20-200q8 0 14-6t6-14q0-8-6-14t-14-6q-8 0-14 6t-6 14q0 8 6 14t14 6ZM200-800v640-640 200-200Zm80 400h147q11-23 25.5-43t32.5-37H280v80Zm0 160h123q-3-20-3-40t3-40H280v80ZM200-80q-33 0-56.5-23.5T120-160v-640q0-33 23.5-56.5T200-880h320l240 240v92q-19-6-39-9t-41-3v-40H480v-200H200v640h227q11 23 25.5 43T485-80H200Zm480-400q83 0 141.5 58.5T880-280q0 83-58.5 141.5T680-80q-83 0-141.5-58.5T480-280q0-83 58.5-141.5T680-480Z"/></svg>                    
                    <span>Knowledgebase</span>
                </a>
            </li>
            <li>
                <a href="analytics.html">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M280-280h80v-200h-80v200Zm320 0h80v-400h-80v400Zm-160 0h80v-120h-80v120Zm0-200h80v-80h-80v80ZM200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z"/></svg>                
                    <span>Reports</span>
                </a>   
            </li>
            <li>
                <a href="profile.html">
                    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-160v-112q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v112H160Zm80-80h480v-32q0-11-5.5-20T700-306q-54-27-109-40.5T480-360q-56 0-111 13.5T260-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T560-640q0-33-23.5-56.5T480-720q-33 0-56.5 23.5T400-640q0 33 23.5 56.5T480-560Zm0-80Zm0 400Z"/></svg>
                    <span>Profile</span>
                </a>
            </li>
        </ul>
    </nav>
    <main>
        <div class="dashboard-header">
            <h2>Admin Dashboard | Ticket Overview</h2>
        </div>
        <div class="container">
            <span class="card">
                <h3>Total Tickets Logged</h3>
                <p id="total-tickets" class="paragraph-font">120</p>
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M480-280q17 0 28.5-11.5T520-320q0-17-11.5-28.5T480-360q-17 0-28.5 11.5T440-320q0 17 11.5 28.5T480-280Zm0-160q17 0 28.5-11.5T520-480q0-17-11.5-28.5T480-520q-17 0-28.5 11.5T440-480q0 17 11.5 28.5T480-440Zm0-160q17 0 28.5-11.5T520-640q0-17-11.5-28.5T480-680q-17 0-28.5 11.5T440-640q0 17 11.5 28.5T480-600Zm320 440H160q-33 0-56.5-23.5T80-240v-160q33 0 56.5-23.5T160-480q0-33-23.5-56.5T80-560v-160q0-33 23.5-56.5T160-800h640q33 0 56.5 23.5T880-720v160q-33 0-56.5 23.5T800-480q0 33 23.5 56.5T880-400v160q0 33-23.5 56.5T800-160Zm0-80v-102q-37-22-58.5-58.5T720-480q0-43 21.5-79.5T800-618v-102H160v102q37 22 58.5 58.5T240-480q0 43-21.5 79.5T160-342v102h640ZM480-480Z"/></svg>
            </span>
            <span class="card">
                <h3>Total Tickets Resolved</h3>
                <p id="total-tickets-resolved" class="paragraph-font">100</p>
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="m368-320 112-84 110 84-42-136 112-88H524l-44-136-44 136H300l110 88-42 136ZM160-160q-33 0-56.5-23.5T80-240v-135q0-11 7-19t18-10q24-8 39.5-29t15.5-47q0-26-15.5-47T105-556q-11-2-18-10t-7-19v-135q0-33 23.5-56.5T160-800h640q33 0 56.5 23.5T880-720v135q0 11-7 19t-18 10q-24 8-39.5 29T800-480q0 26 15.5 47t39.5 29q11 2 18 10t7 19v135q0 33-23.5 56.5T800-160H160Zm0-80h640v-102q-37-22-58.5-58.5T720-480q0-43 21.5-79.5T800-618v-102H160v102q37 22 58.5 58.5T240-480q0 43-21.5 79.5T160-342v102Zm320-240Z"/></svg>
            </span>
            <span class="card">
                <h3>Pending Tickets</h3>
                <p id="total-tickets-resolved" class="paragraph-font">20</p>
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M680-80q-83 0-141.5-58.5T480-280q0-83 58.5-141.5T680-480q83 0 141.5 58.5T880-280q0 83-58.5 141.5T680-80Zm67-105 28-28-75-75v-112h-40v128l87 87Zm-547 65q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h167q11-35 43-57.5t70-22.5q40 0 71.5 22.5T594-840h166q33 0 56.5 23.5T840-760v250q-18-13-38-22t-42-16v-212h-80v120H280v-120h-80v560h212q7 22 16 42t22 38H200Zm280-640q17 0 28.5-11.5T520-800q0-17-11.5-28.5T480-840q-17 0-28.5 11.5T440-800q0 17 11.5 28.5T480-760Z"/></svg>
            </span>
            <span class="card">
                <h3>Average Resolution Time</h3>
                <p id="progress-rating" class="paragraph-font">15 min.</p>
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M480-240q100 0 170-70t70-170q0-100-70-170t-170-70v240L310-310q35 33 78.5 51.5T480-240Zm0 160q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/></svg>
            </span>
            <span class="card">
                <h3>Customer Satisfaction</h3>
                <p id="progress-rating" class="paragraph-font">5</p>
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="m354-287 126-76 126 77-33-144 111-96-146-13-58-136-58 135-146 13 111 97-33 143ZM233-120l65-281L80-590l288-25 112-265 112 265 288 25-218 189 65 281-247-149-247 149Zm247-350Z"/></svg>
            </span>
        </div>
        <div class="container">
            <span class="ticket-details" id="header-font">All Ticket Details</span>
            <span class="ticket-details">
                <div class="input-box">
                    <label for="category">Category</label>
                    <select id="ticket-category" name="category">
                        <option value="">select a category</option>
                        <option value="laptop/pc equipment issue">Laptop/PC Equipment Issue</option>
                        <option value="laptop/pc software issue">Laptop/PC Software Issue</option>
                        <option value="av equipment issue">AV Equipment Issue</option>
                    </select>
                </div>
            </span>
            <span class="ticket-details">
                <div class="input-box">
                    <label for="category">Priority</label>
                    <select id="ticket-priority" name="ticket-priority">
                        <option value="">select a priority</option>
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                        <option value="critical">Critical</option>
                    </select>
                </div>
            </span>
            <span class="ticket-details">
                <div class="input-box">
                    <label for="category">Status</label>
                    <select id="ticket-status" name="ticket-status">
                        <option value="">select a status</option>
                        <option value="open">Open</option>
                        <option value="in progress">In Progress</option>
                        <option value="resolved">Resolved</option>
                        <option value="closed">Closed</option>
                    </select>
                </div>
            </span>
            <div class="ticket-search">
                <div class="input-box">
                    <div class="search-container">
                       <input type="text" id="ticketsearch" name="search" placeholder="Search by ticket ID or subject" onkeyup="searchTicket()">       
                       <div class="dashboard-btn">
                            <button onclick="resetSearch()" class="reset-btn">Reset</button>
                       </div>
                    </div>
                </div>
            </div>
            <!-- <div class="dashboard-btn">
                <input class="search-button" type="button" value="Search">
                <input class="edit-button" type="button" value="Edit">
                <div class="search-container">
                    <button onclick="resetSearch()" class="reset-btn">Reset</button>
                </div>
            </div> -->
        </div>

        <!-- Ticket Table -->
        <div class="ticket-table-container">
            <table class="radio-table">
                <thead id="ticket-table-header">
                   <tr class="table-header">
                        <th>Select</th>
                        <th>Ticket ID</th>
                        <th>Description</th>
                        <th>Category</th>
                        <th>Priority</th>
                        <th>Status</th>
                        <th>Assigned To</th>
                        <th>Created By</th>
                        <th>Location</th>
                        <th>Phone Number</th>
                        <th>Date Created</th>
                    </tr>
                </thead>
                <tbody id="ticket-table-body">
                    <!-- Ticket rows will be dynamically generated here -->
                    <tr class="table-row" data-ticket-id="12345">
                        <td><input type="radio" name="ticketSelect" onclick="loadTicketDetails(this)"></td>
                        <td data-label="Ticket ID">12345</td>
                        <td data-label="Description">Issue with Laptop</td>
                        <td data-label="Category">Laptop/PC Equipment Issue</td>
                        <td data-label="Priority" class="priority-high">High</td>
                        <td data-label="Status">In Progress</td>
                        <td data-label="Assigned To">Joshua Odubu</td>
                        <td data-label="Created By">Jane Smith</td>
                        <td data-label="Location">CSB RM10016</td>
                        <td data-label="Phone Number">07512345678</td>
                        <td data-label="Date Created">2025-10-01</td>
                    </tr>
                    <tr>
                        <td><input type="radio" name="ticketSelect" onclick="loadTicketDetails(this)"></td>
                        <td data-label="Ticket ID">12346</td>
                        <td data-label="Description">Software Installation</td>
                        <td data-label="Category">Laptop/PC Software Issue</td>
                        <td data-label="Priority" class="priority-medium">Medium</td>
                        <td data-label="Status">Open</td>
                        <td data-label="Assigned To">George Taylor</td>
                        <td data-label="Created By">John Doe</td>
                        <td data-label="Location">CSB RM10017</td>
                        <td data-label="Phone Number">07512345679</td>
                        <td data-label="Date Created">2025-10-02</td>
                    </tr>
                    <tr>
                        <td><input type="radio" name="ticketSelect" onclick="loadTicketDetails(this)"></td>
                        <td data-label="Ticket ID">12347</td>
                        <td data-label="Description">AV Equipment Setup</td>
                        <td data-label="Category">AV Equipment Issue</td>
                        <td data-label="Priority" class="priority-low">Low</td>
                        <td data-label="Status">Resolved</td>
                        <td data-label="Assigned To">George Taylor</td>
                        <td data-label="Created By">Mary Johnson</td>
                        <td data-label="Location">CSB RM10018</td>
                        <td data-label="Phone Number">07512345680</td>
                        <td data-label="Date Created">2025-10-03</td>
                    </tr>
                    <tr>
                        <td><input type="radio" name="ticketSelect" onclick="loadTicketDetails(this)"></td>
                        <td data-label="Ticket ID">12348</td>
                        <td data-label="Description">AV Equipment Setup</td>
                        <td data-label="Category">AV Equipment Issue</td>
                        <td data-label="Priority" class="priority-critical">Critical</td>
                        <td data-label="Status">Resolved</td>
                        <td data-label="Assigned To">Joshua Odubu</td>
                        <td data-label="Created By">Mary Johnson</td>
                        <td data-label="Location">CSB RM10018</td>
                        <td data-label="Phone Number">07512345680</td>
                        <td data-label="Date Created">2025-10-03</td>
                    </tr>
                </tbody>
            </table>

            <!-- Modal -->
            <div id="editModal" class="modal">
            <div class="modal-content">
                <span class="close-btn" onclick="closeModal()">&times;</span>
                <h2>Update Ticket</h2>

                <form id="editForm">
                <label for="edit-ticket-id">Ticket ID</label>
                <input type="text" id="edit-ticket-id" name="ticket_id" readonly>

                <label for="edit-subject">Subject</label>
                <input type="text" id="edit-subject" name="subject" readonly>

                <label for="edit-category">Category</label>
                <input type="text" id="edit-category" name="category" readonly>

                <label for="edit-priority">Priority</label>
                <input type="text" id="edit-priority" name="priority" readonly>

                <label for="edit-assigned">Assigned To</label>
                <input type="text" id="edit-assigned" name="assigned_to" readonly>

                <label for="edit-createdby">Created By</label>
                <input type="text" id="edit-createdby" name="created_by" readonly>

                <label for="edit-location">Location</label>
                <input type="text" id="edit-location" name="location" readonly>

                <label for="edit-phone">Phone Number</label>
                <input type="text" id="edit-phone" name="phone_number" readonly>

                <label for="edit-date">Date Created</label>
                <input type="text" id="edit-date" name="date_created" readonly>

                <label for="edit-status">Status</label>
                <select id="edit-status" name="status" required>
                    <option value="open">Open</option>
                    <option value="in progress">In Progress</option>
                    <option value="resolved">Resolved</option>
                    <option value="closed">Closed</option>
                </select>

                <label for="edit-update">Ticket Update</label>
                <textarea id="edit-update" name="ticket_update" rows="4" placeholder="Add your update or comment here..." required></textarea>

                <button type="submit">Save Changes</button>
                </form>
            </div>
            </div>
    </div>
</div>   
</main>
<script>
    document.addEventListener("DOMContentLoaded", function () {
  const tables = document.querySelectorAll("table");

  tables.forEach(table => {
    const headers = Array.from(table.querySelectorAll("thead th")).map(th => th.textContent.trim());

    table.querySelectorAll("tbody tr").forEach(row => {
      row.querySelectorAll("td").forEach((cell, index) => {
        if (headers[index]) {
          cell.setAttribute("data-label", headers[index]);
        }
      });
    });
  });
});

document.addEventListener('DOMContentLoaded', function () {
    const ticketSearchInput = document.getElementById('ticketsearch');
    const categorySelect = document.getElementById('ticket-category');
    const prioritySelect = document.getElementById('ticket-priority');
    const statusSelect = document.getElementById('ticket-status');
    const tableRows = document.querySelectorAll('#ticket-table-body tr');

    function filterTickets() {
        const searchValue = ticketSearchInput.value.toLowerCase();
        const categoryFilter = categorySelect.value.toLowerCase();
        const priorityFilter = prioritySelect.value.toLowerCase();
        const statusFilter = statusSelect.value.toLowerCase();

        tableRows.forEach(row => {
            const ticketId = row.cells[1]?.textContent.toLowerCase();
            const description = row.cells[2]?.textContent.toLowerCase();
            const category = row.cells[3]?.textContent.toLowerCase();
            const priority = row.cells[4]?.textContent.toLowerCase();
            const status = row.cells[5]?.textContent.toLowerCase();

            const matchesSearch = ticketId.includes(searchValue) || description.includes(searchValue);
            const matchesCategory = !categoryFilter || category === categoryFilter;
            const matchesPriority = !priorityFilter || priority === priorityFilter;
            const matchesStatus = !statusFilter || status === statusFilter;

            row.style.display = (matchesSearch && matchesCategory && matchesPriority && matchesStatus) ? '' : 'none';
        });
    }

    function resetSearch() {
        ticketSearchInput.value = '';
        categorySelect.value = '';
        prioritySelect.value = '';
        statusSelect.value = '';
        filterTickets();
    }

    // Expose resetSearch to global so the HTML button onclick can access it
    window.resetSearch = resetSearch;

    // Attach live filter listeners
    ticketSearchInput.addEventListener('keyup', filterTickets);
    categorySelect.addEventListener('change', filterTickets);
    prioritySelect.addEventListener('change', filterTickets);
    statusSelect.addEventListener('change', filterTickets);

    // Modal logic
    const modal = document.getElementById("editModal");
    const openBtn = document.getElementById("openModalBtn"); // Optional, only if present
    const closeBtn = document.querySelector(".close-btn");

    if (openBtn) openBtn.onclick = () => modal.style.display = "block";
    if (closeBtn) closeBtn.onclick = () => modal.style.display = "none";
    window.onclick = e => {
        if (e.target === modal) modal.style.display = "none";
    };
});
</script>
</body>
</html>
